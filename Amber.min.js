/*! amber - v0.1.0 - 2014-02-09 */(function(){"use strict";var a=this,b=a.Amber={};b.VERSION="0.1.0";var c=b._=a._;b.$=a.jQuery||a.Zepto||a.$,b.Supports={tests:{svg:function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},draganddrop:function(){var a=document.createElement("div");return"draggable"in a||"ondragstart"in a&&"ondrop"in a},touch:function(){return"ontouchstart"in window||"onmsgesturechange"in window},cssanimations:function(){var a,b=document.body||document.documentElement,c=b.style,d="transition";if("string"==typeof c[d])return!0;a=["Moz","webkit","Webkit","Khtml","O","ms"],d=d.charAt(0).toUpperCase()+d.substr(1);for(var e=0,f=a.length;f>e;e++)if("string"==typeof c[a[e]+d])return!0;return!1},animationframes:function(){for(var a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;++b)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"];return!!window.requestAnimationFrame}},initialize:function(){for(var a in this.tests)this[a]=c.result(this.tests,a);return this}}.initialize(),b.Format={numberWithCommas:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},stripTrailingZero:function(a){return a.toString().replace(/\.0/,"")},basicPluralize:function(a,b){return isNaN(b)||0>b?void 0:1===b?a:b>1?a+"s":void 0}},b.Browser={iOS:!!navigator.userAgent.match(/iPad|iPhone|iPod/gi),iPhone:!!navigator.userAgent.match(/iPhone/gi),iPad:!!navigator.userAgent.match(/iPad/gi),android:!!navigator.userAgent.match(/Android/gi),blackberry:!!navigator.userAgent.match(/BlackBerry/gi),iemobile:!!navigator.userAgent.match(/IEMobile/gi),firefox:!!navigator.userAgent.match(/Firefox/gi),chrome:!!navigator.userAgent.match(/Chrome/gi),safari:!!navigator.userAgent.match(/(Version\/\d\.\d.*Safari)/gi),ie:navigator.userAgent.match(/MSIE\s([0-9]{1,}[\.0-9]{0,})/gi)||!1,initialize:function(){return this.mobile=this.iOS||this.android||this.blackberry||this.iemobile,this}}.initialize();var d=b.Events={delegateEventSplitter:/^(\S+)\s*(.*)$/,undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},delegateEvents:function(){this.undelegateEvents();for(var a in this.events){var b=this[this.events[a]],d=a.match(this.delegateEventSplitter),e=d[1],f=d[2];b=c.bind(b,this),e+=".delegateEvents"+this.cid,""===f?this.$el.on(e,b):this.$el.on(e,f,b)}return this},on:function(a,b,c){if(!f(this,"on",a,[b,c])||!b)return this;this._events=this._events||{};var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,d){if(!f(this,"once",a,[b,d])||!b)return this;var e=this,g=c.once(function(){e.off(a,g),b.apply(this,arguments)});return g._callback=b,this.on(a,g,d)},off:function(a,b,d){var e,g,h,i,j,k,l,m;if(!this._events||!f(this,"off",a,[b,d]))return this;if(!a&&!b&&!d)return this._events={},this;for(i=a?[a]:c.keys(this._events),j=0,k=i.length;k>j;j++)if(a=i[j],h==this._events[a]){if(this._events[a]=e=[],b||d)for(l=0,m=h.length;m>l;l++)g=h[l],(b&&b!==g.callback&&b!==g.callback._callback||d&&d!==g.context)&&e.push(g);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=[].slice.call(arguments,1);if(!f(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&g(c,b),d&&g(d,arguments),this},stopListening:function(a,b,d){var e=this._listeningTo;if(!e)return this;var f=!b&&!d;d||"object"!=typeof b||(d=this),a&&((e={})[a._listenId]=a);for(var g in e)a=e[g],a.off(b,d,this),(f||c.isEmpty(a._events))&&delete this._listeningTo[g];return this},_ensureElement:function(){if(this.$el)this.setElement(c.result(this,"$el"),!1);else{var a=c.extend({},c.result(this,"attributes"));this.id&&(a.id=c.result(this,"id")),this.className&&(a["class"]=c.result(this,"className"));var d=b.$("<"+c.result(this,"tagName")+">").attr(a);this.setElement(d,!1)}}},e=/\s+/,f=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var f in c)a[b].apply(a,[f,c[f]].concat(d));return!1}if(e.test(c)){for(var g=c.split(e),h=0,i=g.length;i>h;h++)a[b].apply(a,[g[h]].concat(d));return!1}return!0},g=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},h=function(){this.cid=c.uniqueId("vent")};c.extend(h.prototype,d),b.Vent=new h,b.Views={_views:[],_add:function(a){b.Views._views.push(a)},get:function(a){return c.find(b.Views._views,function(b){return b.cid===a})},all:function(){return b.Views._views}};var i=b.View=function(a){this.cid=c.uniqueId("view"),b.Views._add(this),a=a||{},c.extend(this,a),this._ensureElement(),a.$el&&this.setElement(a.$el,!1),a.initializeOnLoad===!0&&this.initialize(),this.delegateEvents()};c.extend(i.prototype,d,{tagName:"div",template:"",events:{},data:{},transitionTime:300,initialize:function(){this.$el&&this.setElement(this.$el,!0)},format:function(){return this},render:function(){return this.trigger("before:render"),this.$el.html(c.template(this.template,this.data)),this.trigger("after:render"),this},$:function(a){return this.$el.find(a)},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,c){return this.$el&&this.undelegateEvents(),this.$el=a instanceof b.$?a:b.$(a),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},svgFallback:function(a){return b.Supports.svg?a:a.replace(/\.svg/g,".png")},transition:function(a,c,d){var e=this;switch(this.trigger("before:transition"),c=c||1){case"forward":c=1;break;case"back":c=-1}a=a instanceof b.$?a:b.$(a),d="string"!=typeof d?"easeInOutExpo":d,b.Supports.cssanimations&&(a.$el.addClass("amber-animate-init").removeClass("amber-animate-in"),this.$el.removeClass("amber-animate-in")),this.undelegateEvents(),this.$el.animate({left:$(window).width()*-c},this.transitionTime,d,function(){$(this).hide(),e.trigger("after:transition")}),a.initialize(),a.$el.show().css({left:$(window).width()*c}).show().animate({left:0},this.transitionTime,d,function(){b.Supports.cssanimations&&a.$el.addClass("amber-animate-in")})}});var j=function(a,b){var d,e=this;d=a&&c.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},c.extend(d,e,b);var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,a&&c.extend(d.prototype,a),d.__super__=e.prototype,d};i.extend=j,b.Animate={scrollTo:function(a,c,d){c=c||0,a=a instanceof b.$?a:b.$(a),d="string"!=typeof d?"easeInOutExpo":d,$("html, body").animate({scrollTop:a.offset().top-c},500,d)}};var k=b.Animate.AnimateIn=function(a,b){this.el=a,this.options=j(this.defaults,b),this._init()};k.prototype={defaults:{viewportFactor:.2},docElem:window.document.documentElement,getViewportHeight:function(){var a=this.docElem.clientHeight,b=window.innerHeight;return b>a?b:a},getOffset:function(a){var b=0,c=0;do isNaN(a.offsetTop)||(b+=a.offsetTop),isNaN(a.offsetLeft)||(c+=a.offsetLeft);while(a==a.offsetParent);return{top:b,left:c}},inViewport:function(a,b){var c=a.offsetHeight,d=window.pageYOffset||this.docElem.scrollTop,e=d+this.getViewportHeight(),f=this.getOffset(a).top,g=f+c;return b=b||0,e>=f+c*b&&g>=d},_init:function(){if(!Modernizr.touch){this.sections=Array.prototype.slice.call(this.el.querySelectorAll(".amber-animate-section")),this.didScroll=!1;var a=this;this.sections.forEach(function(b){a.inViewport(b)||$(b).addClass("amber-animate-section-init")});var b=function(){a.didScroll||(a.didScroll=!0,setTimeout(function(){a._scrollPage()},100))},c=function(){function b(){a._scrollPage(),a.resizeTimeout=null}a.resizeTimeout&&clearTimeout(a.resizeTimeout),a.resizeTimeout=setTimeout(b,200)};window.addEventListener("scroll",b,!1),window.addEventListener("resize",c,!1)}},_scrollPage:function(){var a=this;this.sections.forEach(function(b){a.inViewport(b,a.options.viewportFactor)?$(b).addClass("amber-animate-section-animate"):($(b).addClass("amber-animate-section-init"),$(b).removeClass("amber-animate-section-animate"))}),this.didScroll=!1}}}).call(this);